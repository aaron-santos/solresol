(ns solresol.core
  (:use [clojure.java.io]
        [clojure.string]
        ;[overtone.live]
        ))

;; Define some solfege
(defn solfege->note [s]
  ({:do  0
    :re  2
    :mi  4
    :fa  5
    :sol 7
    :la  9
    :si  11} s))

(defn solresol-letter->solfege [c]
  ({"d"  :do
    "r"  :re
    "m"  :mi
    "f"  :fa
    "so" :sol
    "l"  :la
    "s"  :si} c))

;; Grab http://www.ifost.org.au/~gregb/solresol/sorsolex.htm
;; And parse it out
;(let [page         (slurp "http://www.ifost.org.au/~gregb/solresol/sorsolex.htm")
;      lines        (-> page (split #"<P>") (get 4) (split #"<br>"))
;      s-lines      (remove empty? (map #(remove blank? (split % #"<B>|</B>")) lines))
;      p-lines      (map (fn [[k v]] [(keyword (trim (first (split v #" |\[")))) k]) s-lines)
;      m-lines      (reduce #(apply assoc %1 %2) {} p-lines)]
;      (pprint m-lines))

;; With a little manual adjustment...
(def dictionary
  {:magazine            "smld"
   :black               "sodrl"
   :opposite            "mmfr"
   :refuse              "mdld"
   :violet              "lrmr"
   :age                 "sofmd"
   :constitute          "srls"
   :admire              "mdso"
   :in                  "sor"
   :yes                 "s"
   :liking              "mdr"
   :furniture           "rfdm"
   :thoughtless         "dsfd"
   :unwise              "dsfd"
   :night               "lls"
   :music               "somsor"
   :Friday              "sosol"
   :goodness            "dflr"
   :quality             "dfmr"
   :drink               "dsol"
   :tone                "somfso"
   :bookstore           "llrl"
   :bleach              "rldr"
   :useful              "rsosd"
   :today               "somm"
   :watchmaker          "llfd"
   :information         "fsr"
   :dictionary          "sorl"
   :everywhere          "mmfso"
   :manufacture         "ldrm"
   :read                "ldf"
   :not                 "d"
   :no                  "d"
   :eleven              "mml"
   :last                "msll"
   :all                 "lmsos"
   :autumn              "dds"
   :continuer           "rsoml"
   :Tuesday             "sosor"
   :progress            "sdl"
   :orchestra           "sodsd"
   :cut                 "rfsso"
   :pleasure            "mfd"
   :gradually           "mrrso"
   :water               "dsos"
   :October             "rrso"
   :descend             "slso"
   :camphor             "fmrr"
   :taste               "dmrso"
   :brother             "rsmr"
   :repugnance          "rdm"
   :subtract            "lfdf"
   :begin               "sdf"
   :date                "fdf"
   :transport           "fsrf"
   :propose             "lrfr"
   :white               "lrdso"
   :fruit               "dsrl"
   :mother              "rsds"
   :merchandise         "lmlf"
   :stamp               "fmd"
   :sense               "dmrl"
   :sailor              "fsolm"
   :be                  "frm"
   :hundred             "frr"
   :rain                "ssd"
   :continual           "rsoml"
   :candor              "dfld"
   :summer              "ddl"
   :chemist             "ffrso"
   :abridge             "sorf"
   :succeed             "sodsos"
   :lose                "slsl"
   :soup                "dlfso"
   :league              "fldf"
   :army                "fmfr"
   :display             "lsofd"
   :hide                "rsodf"
   :February            "dmm"
   :entertain           "lsr"
   :thirsty             "dsof"
   :wife                "msf"
   :beautiful           "dfsom"
   :health              "rdff"
   :hammer              "rsoff"
   :father              "rsds"
   :give                "rml"
   :after               "frdm"
   :theater             "sodrm"
   :mix                 "lmdso"
   :red                 "lrms"
   :flour               "lsoss"
   :work                "rsosr"
   :fall                "ssosl"
   :republic            "srsl"
   :Thursday            "sosof"
   :other               "ds"
   :girl                "sl"
   :fifteen             "mff"
   :listen              "rsod"
   :sculpture           "solmf"
   :speed               "fsmr"
   :mare                "frsod"
   :prefer              "mdf"
   :honesty             "dfsso"
   :schoolgirl          "ldm"
   :machine             "rssd"
   :whose               "mf"
   :linen               "rfld"
   :equality            "msol"
   :something           "lsd"
   :go                  "rmrd"
   :thousand            "fmm"
   :umbrella            "rdsos"
   :kill                "ssosf"
   :morning             "llf"
   :what                "fd"
   :painting            "soldl"
   :measure             "lfld"
   :equipment           "rsdd"
   :learn               "sds"
   :food                "dlfr"
   :detest              "slm"
   :industry            "ldrd"
   :sit                 "rfrf"
   :ask                 "rfl"
   :finish              "fds"
   :numbering           "lfdr"
   :call                "dsodr"
   :winter              "ddf"
   :heal                "flrl"
   :close               "sodsod"
   :May                 "dll"
   :undertake           "mrdl"
   :December            "rrs"
   :bulk                "ldrs"
   :universe            "dmd"
   :son                 "rsrso"
   :write               "lmr"
   :pull                "fsorl"
   :masonry             "rrdl"
   :equal               "rfsof"
   :meet                "msorl"
   :bread               "dsom"
   :lodge               "rmfs"
   :know                "solsr"
   :fire                "rfsod"
   :matter              "ldrf"
   :help                "dsd"
   :politics            "srsr"
   :sugar               "dsfs"
   :post                "frl"
   :superstition        "dmss"
   :paper               "lfd"
   :tinsmiths           "lmmd"
   :name                "rssor"
   :slander             "mlrl"
   :Wednesday           "sosom"
   :gardening           "fdsd"
   :word                "lds"
   :franc               "lfsol"
   :continuation        "rsoml"
   :boy                 "sl"
   :spring              "ddso"
   :produce             "ldrso"
   :remember            "soml"
   :railroad            "fsrd"
   :railway             "fsrd"
   :corrupt             "fdr"
   :surgeon             "ffdso"
   :look!               "ml"
   :seven               "mmd"
   :two                 "rmm"
   :middle              "sdsd"
   :Easter              "dffd"
   :pencil              "lsod"
   :comfort             "fdss"
   :let                 "sofl"
   :before              "mmfd"
   :happy               "msso"
   :again               "sfs"
   :grocery             "lsodd"
   :responsibility      "msmf"
   :selfishness         "mfrd"
   :play                "mlsr"
   :harvest             "frmf"
   :season              "ddm"
   :think               "rdr"
   :wine                "dlrs"
   :or                  "m"
   :bier                "sosdd"
   :color               "lrdr"
   :meter               "lsorf"
   :forty               "ffso"
   :receive             "msorso"
   :consultation        "ffdm"
   :station             "fsls"
   :daughter            "rsrso"
   :lie                 "rsolm"
   :orphan              "mdfso"
   :misfortune          "sosm"
   :sing                "sormf"
   :wind                "ssr"
   :internationalism    "sfmr"
   :accident            "fsfso"
   :confidence          "mlr"
   :enemy               "sdm"
   :good                "fl"
   :June                "dss"
   :count               "lrlr"
   :clothing            "rdfs"
   :eight               "mmr"
   :serve               "fmr"
   :thirty              "ffm"
   :six                 "rss"
   :hair                "drdso"
   :guarantee           "lsolf"
   :multiply            "lfdso"
   :climb               "sols"
   :sail                "fldr"
   :here                "lm"
   :commerce            "ldfd"
   :agriculture         "frdr"
   :eye                 "drmr"
   :ink                 "lml"
   :migraine            "sosord"
   :dog                 "frsr"
   :same                "sd"
   :hesitate            "lsf"
   :calculate           "lrlm"
   :preference          "mdf"
   :chocolate           "dssod"
   :magistracy          "ssdso"
   :September           "rrf"
   :April               "dsoso"
   :cabinet-work        "rlld"
   :inexpensive         "rlml"
   :someone             "dl"
   :sacrifice           "mdsd"
   :muslin              "ldld"
   :bakery              "dsrs"
   :question            "ssos"
   :market              "sdfs"
   :deaf                "srmd"
   :loan                "rslm"
   :beer                "dsfr"
   :row                 "fldso"
   :instrument          "sodsr"
   :finance             "ssomr"
   :Monday              "sosod"
   :return              "rsof"
   :sixty               "ffs"
   :able                "flr"
   :their               "rs"
   :restaurant          "sdfso"
   :change              "msodl"
   :his                 "rf"
   :good-day            "sm"
   :town                "sdrd"
   :cash                "lfsod"
   :assortment          "lsofm"
   :half                "lfrl"
   :your                "rm"
   :family              "rsdso"
   :telegraph           "sosld"
   :notions             "lsmso"
   :almost              "mdrr"
   :cold                "lss"
   :at                  "f"
   :fog                 "lrr"
   :regiment            "fmfl"
   :thunder             "ssso"
   :Saturday            "sosos"
   :sick                "ffdr"
   :with                "mmsor"
   :hour                "soll"
   :encounter           "rfso"
   :sew                 "rflf"
   :eat                 "dsor"
   :compare             "sld"
   :interpret           "sodso"
   :diplomacy           "srsd"
   :earn                "lsls"
   :that                "mr"
   :enter               "msor"
   :language            "sorso"
   :oculist             "ffds"
   :suffocation         "sofdd"
   :much                "fs"
   :nine                "mmf"
   :butchers            "lsdd"
   :five                "rll"
   :expense             "lmlr"
   :rest                "rsolso"
   :truth               "dfsos"
   :boat                "fsols"
   :but                 "sod"
   :remain              "msrd"
   :light               "dsomf"
   :recede              "smsf"
   :humanity            "dfls"
   :ice                 "lsoso"
   :live                "dmfr"
   :convalescence       "fmmd"
   :each                "sr"
   :cat                 "frsm"
   :country             "sfrm"
   :unite               "flsos"
   :indiscretion        "msfd"
   :tear/rip            "rflr"
   :do                  "fsol"
   :million             "fsoso"
   :store               "ldmr"
   :by                  "lr"
   :generosity          "dflso"
   :thank               "sos"
   :of                  "ls"
   :preferable          "mdf"
   :my                  "rd"
   :abandon             "mdfl"
   :gospel              "ddsod"
   :experience          "mssod"
   :gram                "lfsf"
   :forget              "lmso"
   :month               "drso"
   :exactitude          "srf"
   :fourteen            "mrr"
   :sleep               "rmsod"
   :correct             "srso"
   :street              "sdrs"
   :joy                 "sosr"
   :pass/cross          "rfr"
   :century             "drs"
   :book                "ldso"
   :rise                "dsofm"
   :for                 "md"
   :hear                "dmrs"
   :car                 "rmrf"
   :I                   "dr"
   :ease                "sml"
   :reply               "rfs"
   :pardon              "solm"
   :cry                 "fsso"
   :horse               "frsod"
   :woman               "dmfd"
   :yesterday           "sorr"
   :hardware            "llrs"
   :advance             "fsms"
   :mister              "sso"
   :example             "sodm"
   :split               "rsom"
   :sleepy              "rld"
   :decide              "fsl"
   :letter-carrier      "fml"
   :space               "fldm"
   :husband             "msf"
   :purgation           "sollr"
   :child               "dmfso"
   :string              "lrsom"
   :anatomy             "fsll"
   :one                 "rdd"
   :buy                 "lrdl"
   :harmony             "somsos"
   :laziness            "mfmf"
   :snow                "lff"
   :hail                "lff"
   :possess             "fmso"
   :difficulty          "lms"
   :literature          "sosdr"
   :how                 "mddr"
   :sharing             "lfds"
   :way                 "fssof"
   :exposition          "lsofr"
   :left                "fflr"
   :prepare             "fsos"
   :take                "lrsol"
   :oneself             "dso"
   :place               "sdmd"
   :ten                 "mmso"
   :if                  "so"
   :behind              "dfmm"
   :acquainted          "rdso"
   :mend                "rflm"
   :warmth              "dflf"
   :police              "slmd"
   :find                "rlsom"
   :friend              "mds"
   :establish           "ldmd"
   :come                "msod"
   :Mrs                 "sso"
   :testimony           "ssmd"
   :see                 "dmrm"
   :divide              "lfdl"
   :through             "fssor"
   :throughout          "fssor"
   :you                 "dm"
   :November            "rrl"
   :address             "frd"
   :travel              "fsdr"
   :sensitivity         "dflm"
   :wash                "rdmd"
   :doctor              "ffdf"
   :egg                 "dsds"
   :senses              "dmrd"
   :signature           "fdso"
   :reciprocity         "mdl"
   :locksmith           "rffm"
   :look                "rfd"
   :tomorrow            "soff"
   :July                "rrd"
   :cooking             "dssof"
   :bad                 "som"
   :lesson              "lrso"
   :visit               "rmrso"
   :meat                "dlsod"
   :shirt               "rdrf"
   :coffee              "dsfso"
   :say                 "dmld"
   :our                 "rso"
   :shoe                "rdrl"
   :vegetable           "dsdm"
   :continually         "rsoml"
   :add                 "lfdm"
   :heat                "ssl"
   :ethics              "rdf"
   :little              "sf"
   :sun                 "sff"
   :hold                "rlfs"
   :time                "drd"
   :open                "dsodso"
   :stairs              "rmsso"
   :air                 "sdd"
   :touch               "dmrf"
   :explain             "smr"
   :never               "lso"
   :house               "rmfl"
   :thirteen            "mdd"
   :hungry              "dsod"
   :eighty              "fdd"
   :new                 "sosfs"
   :liberty             "dmsm"
   :earth               "ddr"
   :three               "rff"
   :study               "sdso"
   :yellow              "lrmso"
   :this                "fm"
   :means               "flm"
   :price               "lrsd"
   :March               "dff"
   :press               "llmd"
   :walk                "rmrm"
   :dentist             "ffdl"
   :imprisonment        "sslf"
   :August              "rrm"
   :danger              "sofll"
   :without             "mssr"
   :dead                "rfmd"
   :necessary           "fld"
   :conscience          "dfsf"
   :like                "mls"
   :fifty               "ffl"
   :he                  "df"
   :body                "drdm"
   :why                 "fso"
   :copy                "sodr"
   :wait                "dfdr"
   :she                 "df"
   :the                 "l"
   :tired               "rsold"
   :value               "lrsr"
   :carry               "fms"
   :four                "rsoso"
   :fear                "mdsod"
   :letter              "fdm"
   :god                 "dms"
   :permit              "solso"
   :milk                "dsrd"
   :government          "srdr"
   :guide               "dsosf"
   :municipality        "sdms"
   :glass               "dlrso"
   :repeat              "sfl"
   :always              "sol"
   :wish                "mfl"
   :Sunday              "sodd"
   :enough              "dsdr"
   :sell                "ldrl"
   :continue            "rsoml"
   :preferably          "mdf"
   :pliers              "rsorr"
   :sister              "rsmr"
   :build               "rrdr"
   :specimen            "lsomr"
   :understand          "flf"
   :election            "srdso"
   :pen                 "lmf"
   :however             "mmdm"
   :strategy            "fsomr"
   :flood               "flfr"
   :Satan               "smd"
   :twelve              "mms"
   :centime             "lfsos"})
  
(defn word->notes [word]
  (map #(-> % solresol-letter->solfege solfege->note) (re-seq #"d|r|m|f|so|l|s" word)))

(defn phrase->notes [phrase]
  (map #(word->notes (dictionary %)) phrase))


